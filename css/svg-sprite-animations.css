/* 감자·토끼 가계부 - SVG 스프라이트 애니메이션 시스템 */
/* 애니메이션 토큰과 통합된 SVG 아이콘 애니메이션 유틸리티 */

/* === SVG 스프라이트 최적화 === */

/* SVG 스프라이트 조기 로딩 */
@supports (display: block) {
  html::after {
    content: '';
    display: none;
    background-image: url('../icons.svg');
    /* 브라우저가 스프라이트를 미리 로드하도록 힌트 제공 */
  }
}

/* === 리액션 애니메이션 유틸리티 === */

/* 성공 반응 - 기쁜 바운스 */
.react-success {
  animation: 
    success-bounce var(--reaction-success-duration) var(--reaction-success-ease),
    success-glow var(--dur-lg) var(--ease-smooth);
  color: var(--color-success);
  filter: 
    drop-shadow(0 0 var(--spacing-xs) rgba(49, 208, 170, 0.4))
    brightness(1.1);
  transform-origin: center;
}

/* 경고 반응 - 주의 흔들림 */
.react-warn {
  animation: warning-shake var(--reaction-warning-duration) var(--reaction-warning-ease);
  animation-iteration-count: var(--reaction-warning-cycles);
  color: var(--color-warning);
  filter: 
    drop-shadow(0 0 var(--spacing-xs) rgba(255, 178, 55, 0.4))
    saturate(1.2);
  transform-origin: center;
}

/* 정보 반응 - 부드러운 펄스 */
.react-info {
  animation: info-pulse var(--reaction-info-duration) var(--reaction-info-ease);
  animation-iteration-count: var(--reaction-info-iterations);
  color: var(--color-primary);
  filter: 
    drop-shadow(0 0 var(--spacing-xs) rgba(31, 199, 212, 0.3))
    brightness(1.05);
  transform-origin: center;
}

/* 에러 반응 - 격렬한 흔들림 */
.react-error {
  animation: error-shake var(--reaction-error-duration) var(--reaction-error-ease);
  animation-iteration-count: var(--reaction-error-cycles);
  color: var(--color-error);
  filter: 
    drop-shadow(0 0 var(--spacing-xs) rgba(237, 75, 158, 0.5))
    contrast(1.1);
  transform-origin: center;
}

/* === 캐릭터별 특별 애니메이션 === */

/* 감자 캐릭터 애니메이션 */
.react-potato-happy {
  animation: 
    potato-happy-wiggle var(--dur-md) var(--ease-potato),
    success-glow var(--dur-lg) var(--ease-smooth);
  animation-iteration-count: 2, 1;
  color: var(--color-potato);
  filter: drop-shadow(var(--character-potato-shadow));
  transform-origin: center;
}

.react-potato-bounce {
  animation: potato-gentle-bounce var(--dur-lg) var(--ease-potato) infinite;
  color: var(--color-potato);
  filter: drop-shadow(var(--character-potato-shadow));
  transform-origin: center bottom;
}

.react-potato-idle {
  animation: 
    potato-gentle-bounce var(--dur-2xl) var(--ease-smooth) infinite,
    float var(--dur-2xl) var(--ease-smooth) infinite;
  animation-delay: 0s, calc(var(--dur-2xl) / 2);
  color: var(--color-potato);
  transform-origin: center;
}

/* 토끼 캐릭터 애니메이션 */
.react-rabbit-hop {
  animation: rabbit-quick-hop var(--dur-md) var(--ease-rabbit);
  color: var(--color-rabbit);
  filter: drop-shadow(var(--character-rabbit-shadow));
  transform-origin: center bottom;
}

.react-rabbit-alert {
  animation: rabbit-ear-twitch var(--dur-xs) var(--ease-sharp);
  animation-iteration-count: 5;
  color: var(--color-rabbit);
  filter: drop-shadow(var(--character-rabbit-shadow));
  transform-origin: center;
}

.react-rabbit-excited {
  animation: 
    rabbit-quick-hop var(--dur-sm) var(--ease-rabbit) 3,
    success-glow var(--dur-lg) var(--ease-smooth);
  color: var(--color-rabbit);
  filter: drop-shadow(var(--character-rabbit-shadow)) brightness(1.1);
  transform-origin: center bottom;
}

/* === 상황별 조합 애니메이션 === */

/* 거래 추가 성공 */
.react-transaction-success {
  animation: 
    success-bounce var(--dur-md) var(--ease-bouncy),
    shimmer var(--dur-xl) linear;
  color: var(--color-income);
  filter: 
    drop-shadow(0 var(--spacing-xs) var(--spacing-lg) rgba(49, 208, 170, 0.3))
    brightness(1.2);
}

/* 예산 초과 경고 */
.react-budget-warning {
  animation: 
    warning-shake var(--dur-sm) var(--ease-sharp) 2,
    error-glow var(--dur-lg) var(--ease-smooth);
  color: var(--color-expense);
  filter: 
    drop-shadow(0 var(--spacing-xs) var(--spacing-lg) rgba(237, 75, 158, 0.4))
    saturate(1.3);
}

/* 로딩 상태 */
.react-loading {
  animation: 
    info-pulse var(--dur-lg) var(--ease-smooth) infinite,
    spin var(--dur-2xl) linear infinite;
  color: var(--color-primary);
  opacity: 0.8;
  transform-origin: center;
}

/* 데이터 없음 상태 */
.react-empty {
  animation: 
    float var(--dur-2xl) var(--ease-smooth) infinite,
    empty-fade var(--dur-xl) var(--ease-smooth) infinite alternate;
  color: var(--color-text-disabled);
  opacity: 0.7;
  transform-origin: center;
}

/* === 추가 애니메이션 키프레임 === */

/* 성공 글로우 효과 */
@keyframes success-glow {
  0% {
    filter: drop-shadow(0 0 var(--spacing-xs) rgba(49, 208, 170, 0.3));
  }
  50% {
    filter: drop-shadow(0 0 var(--spacing-lg) rgba(49, 208, 170, 0.6));
  }
  100% {
    filter: drop-shadow(0 0 var(--spacing-xs) rgba(49, 208, 170, 0.3));
  }
}

/* 에러 글로우 효과 */
@keyframes error-glow {
  0% {
    filter: drop-shadow(0 0 var(--spacing-xs) rgba(237, 75, 158, 0.4));
  }
  50% {
    filter: drop-shadow(0 0 var(--spacing-lg) rgba(237, 75, 158, 0.7));
  }
  100% {
    filter: drop-shadow(0 0 var(--spacing-xs) rgba(237, 75, 158, 0.4));
  }
}

/* 빈 상태 페이드 */
@keyframes empty-fade {
  0% {
    opacity: 0.4;
  }
  100% {
    opacity: 0.8;
  }
}

/* 관심 끌기 애니메이션 */
@keyframes attention-wobble {
  0%, 100% {
    transform: rotate(0deg) scale(1);
  }
  15% {
    transform: rotate(-5deg) scale(1.05);
  }
  30% {
    transform: rotate(3deg) scale(1.02);
  }
  45% {
    transform: rotate(-2deg) scale(1.03);
  }
  60% {
    transform: rotate(1deg) scale(1.01);
  }
}

/* 축하 폭발 효과 */
@keyframes celebration-burst {
  0% {
    transform: scale(1) rotate(0deg);
    filter: hue-rotate(0deg);
  }
  25% {
    transform: scale(1.2) rotate(5deg);
    filter: hue-rotate(90deg);
  }
  50% {
    transform: scale(1.1) rotate(-3deg);
    filter: hue-rotate(180deg);
  }
  75% {
    transform: scale(1.15) rotate(2deg);
    filter: hue-rotate(270deg);
  }
  100% {
    transform: scale(1) rotate(0deg);
    filter: hue-rotate(360deg);
  }
}

/* === 조합 애니메이션 유틸리티 === */

/* 주의 끌기 */
.react-attention {
  animation: attention-wobble var(--dur-lg) var(--ease-bouncy) 3;
  color: var(--color-warning);
}

/* 축하 효과 */
.react-celebration {
  animation: 
    celebration-burst var(--dur-xl) var(--ease-bouncy),
    success-glow var(--dur-2xl) var(--ease-smooth);
  color: var(--color-success);
}

/* 부드러운 등장 */
.react-enter {
  animation: 
    modal-scale-in var(--dur-md) var(--ease-bouncy),
    success-glow var(--dur-lg) var(--ease-smooth);
}

/* 부드러운 사라짐 */
.react-exit {
  animation: modal-fade-out var(--dur-sm) var(--ease-sharp);
}

@keyframes modal-fade-out {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.9);
  }
}

/* === 스태거링 애니메이션 지원 === */

/* 순차 등장 애니메이션 */
.stagger-enter:nth-child(1) { animation-delay: calc(var(--dur-xxs) * 0); }
.stagger-enter:nth-child(2) { animation-delay: calc(var(--dur-xxs) * 1); }
.stagger-enter:nth-child(3) { animation-delay: calc(var(--dur-xxs) * 2); }
.stagger-enter:nth-child(4) { animation-delay: calc(var(--dur-xxs) * 3); }
.stagger-enter:nth-child(5) { animation-delay: calc(var(--dur-xxs) * 4); }
.stagger-enter:nth-child(6) { animation-delay: calc(var(--dur-xxs) * 5); }
.stagger-enter:nth-child(7) { animation-delay: calc(var(--dur-xxs) * 6); }
.stagger-enter:nth-child(8) { animation-delay: calc(var(--dur-xxs) * 7); }
.stagger-enter:nth-child(9) { animation-delay: calc(var(--dur-xxs) * 8); }
.stagger-enter:nth-child(10) { animation-delay: calc(var(--dur-xxs) * 9); }

.stagger-enter {
  animation: react-enter var(--dur-md) var(--ease-smooth);
}

/* === 인터렉션 반응 === */

/* 호버 반응 */
.icon-hover-bounce:hover {
  animation: success-bounce var(--dur-sm) var(--ease-bouncy);
}

.icon-hover-pulse:hover {
  animation: info-pulse var(--dur-md) var(--ease-smooth) 2;
}

.icon-hover-wiggle:hover {
  animation: potato-happy-wiggle var(--dur-sm) var(--ease-potato);
}

/* 클릭 반응 */
.icon-click-scale:active {
  animation: none;
  transform: scale(var(--btn-active-scale));
  transition: transform var(--dur-xxs) var(--ease-sharp);
}

/* 포커스 반응 */
.icon-focus-glow:focus-visible {
  animation: info-pulse var(--dur-md) var(--ease-smooth) infinite;
  outline: var(--spacing-xs) solid var(--color-primary);
  outline-offset: var(--spacing-xs);
}

/* === 테마별 최적화 === */

/* 다크 테마 애니메이션 강화 */
:root[data-theme='dark'] .react-success {
  filter: 
    drop-shadow(0 0 var(--spacing-sm) rgba(104, 255, 218, 0.5))
    brightness(1.2);
}

:root[data-theme='dark'] .react-error {
  filter: 
    drop-shadow(0 0 var(--spacing-sm) rgba(255, 101, 184, 0.6))
    contrast(1.2);
}

:root[data-theme='dark'] .react-info {
  filter: 
    drop-shadow(0 0 var(--spacing-sm) rgba(51, 225, 237, 0.4))
    brightness(1.3);
}

/* 고대비 테마 - 애니메이션 단순화 */
:root[data-theme='hc'] .react-success,
:root[data-theme='hc'] .react-error,
:root[data-theme='hc'] .react-info,
:root[data-theme='hc'] .react-warn {
  filter: none;
  animation-duration: calc(var(--dur-sm) * 0.7);
}

/* === 성능 최적화 === */

/* GPU 가속 활성화 */
[class*="react-"],
[class*="animate-"],
.icon-hover-bounce,
.icon-hover-pulse,
.icon-hover-wiggle,
.stagger-enter {
  will-change: transform, filter;
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* 애니메이션 종료시 최적화 해제 */
[class*="react-"]:not(.react-loading):not(.react-potato-bounce):not(.react-potato-idle) {
  animation-fill-mode: forwards;
}

[class*="react-"].animation-ended {
  will-change: auto;
  transform: none;
}

/* === 접근성 고려사항 === */

/* 줄어든 모션 선호시 */
@media (prefers-reduced-motion: reduce) {
  [class*="react-"],
  [class*="animate-"],
  .icon-hover-bounce:hover,
  .icon-hover-pulse:hover,
  .icon-hover-wiggle:hover,
  .stagger-enter {
    animation: none !important;
    transition: none !important;
  }
  
  /* 필수 피드백만 최소한 유지 */
  .react-error {
    animation: error-shake 50ms linear !important;
  }
  
  .react-success {
    animation: success-bounce 100ms ease-out !important;
  }
  
  /* 상태 변화는 즉시 색상으로 표시 */
  .react-success { color: var(--color-success); }
  .react-error { color: var(--color-error); }
  .react-warn { color: var(--color-warning); }
  .react-info { color: var(--color-primary); }
}

/* 고대비 선호시 추가 보강 */
@media (prefers-contrast: high) {
  [class*="react-"] {
    filter: contrast(1.5) !important;
    font-weight: var(--font-weight-bold);
  }
}

/* === 디버그 모드 (개발용) === */
.debug-animations [class*="react-"]::before {
  content: attr(class);
  position: absolute;
  top: -20px;
  left: 0;
  font-size: 10px;
  background: rgba(255, 255, 255, 0.9);
  color: #000;
  padding: 2px 4px;
  border-radius: 2px;
  z-index: 999;
  pointer-events: none;
  font-family: monospace;
}

/* 애니메이션 바운딩 박스 표시 */
.debug-animations [class*="react-"] {
  outline: 1px dashed rgba(255, 0, 255, 0.5);
  outline-offset: 2px;
}